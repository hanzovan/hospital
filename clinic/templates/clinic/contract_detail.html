{% extends "clinic/layout.html" %}
{% load static %}
{% block title %}

    contract detail

{% endblock %}
{% block main %}

    <h1 class="text-center page-title">Contract Detail</h1>
    <table class="table table-hover">
        <tr>
            <th>Contract ID</th>
            <td>{{ contract.id }}</td>
        </tr>
        <tr>
            <th>Client</th>
            <td>{{ contract.client.name }}</td>
        </tr>
        <tr>
            <th>Services</th>
            <td>
                {% for service in contract.services.all.values %}

                    {% if not forloop.last %}

                        {{ service.name }},

                    {% else %}

                        {{ service.name }}

                    {% endif %}

                {% endfor %}
            </td>
        </tr>
        <tr>
            <th>Male Headcount</th>
            <td>{{ contract.male_headcount }}</td>
        </tr>
        <tr>
            <th>Female Headcount</th>
            <td>{{ contract.female_headcount }}</td>
        </tr>
        <tr>
            <th>Initiation Date</th>
            <td>{{ contract.initiation_date }}</td>
        </tr>
        <tr>
            <th>Date Created</th>
            <td>{{ contract.created }}</td>
        </tr>
        <tr>
            <th>Created by</th>
            <td>{{ contract.created_by.username }}</td>
        </tr>
        <tr>
            <th>Contract file</th>
            <td>
                {% if contract.pdf_file %}

                    <a class="no-underline" href="{{ contract.pdf_file.url }}" target="_blank">View file</a>

                {% else %}

                    N/A

                {% endif %}
            </td>
        </tr>
        <tr>
            <th>Status</th>
            <td>
                {% if contract.archived %}

                    Archived

                {% else %}
                    <div><span style="color: green;">Active</span></div>
                    
                    <form action="{% url 'archive_contract' %}" method="post" onsubmit="return confirm('Do you really want to archive this contract?');">
                        {% csrf_token %}
                        <input name="contract_id" value="{{ contract.id }}" type="hidden">
                        <span><i>If this contract was finished,</i></span>
                        <button class="btn btn-link no-underline"><span style="color: red;">Archive this contract</span></button>
                    </form>

                {% endif %}
            </td>
        </tr>
        
    </table>
    <div class="general">
        <a href="{% url 'generate_contract_docx' contract.id %}" class="btn btn-primary" style="margin: 1.5em 0 1.5em 0;">Generate Word Document</a>
    </div>
    
{% endblock %}